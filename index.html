<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" sizes="32x32" href="/images/logo_white_transparent-YanJ4l86raHEGQwp.webp?v=3">
    <link rel="apple-touch-icon" href="/images/logo_white_transparent-YanJ4l86raHEGQwp.webp?v=3">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,700&family=Manrope:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,600;9..144,700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

    <title>Maison Daouia</title>

    <script>
      /* -------------------------------------------------------
         FUNCTION: UPDATE BADGE BASED ON CURRENT LANGUAGE
      ------------------------------------------------------- */
      function updateBadge() {
        const lang = (localStorage.getItem("i18nextLng") || "fr").toLowerCase();

        let badge = document.querySelector("#mgh-badge");

        // Create badge container if missing
        if (!badge) {
          badge = document.createElement("a");
          badge.href = "https://maison-daouia.hotelrunner.com/bv3/search";
          badge.target = "_blank";
          badge.id = "mgh-badge";

          const img = document.createElement("img");
          img.id = "mgh-badge-img";

          badge.appendChild(img);
          document.body.appendChild(badge);
        }

        // Select the <img>
        const img = document.querySelector("#mgh-badge-img");

        // Apply language-based image
        if (lang.startsWith("en")) {
          img.src = "/images/gallery/ChatGPT_Image_Dec_5__2025__03_23_08_PM-removebg-preview.png";
          img.alt = "Book direct, best price";
          img.title = "Book direct, best price";
        } else {
          img.src = "/images/gallery/ChatGPT_Image_Dec_5__2025__03_20_39_PM-removebg-preview.png";
          img.alt = "Réservez en direct, meilleur prix";
          img.title = "Réservez en direct, meilleur prix";
        }
      }

      /* Run once on page load */
      document.addEventListener("DOMContentLoaded", () => {
        updateBadge();

        /* -------------------------
           WhatsApp Floating Button
        ------------------------- */
        const pageLang = (localStorage.getItem("i18nextLng") || "fr").toLowerCase();

        if (!document.querySelector(".whatsapp-float")) {
          const btn = document.createElement("div");
          btn.className = "whatsapp-float";
          btn.innerHTML = '<i class="fab fa-whatsapp"></i>';
          btn.onclick = () => window.open("https://wa.me/212666915556", "_blank");

          const tooltip = document.createElement("div");
          tooltip.className = "whatsapp-tooltip";

          let tooltipMsg = "Bienvenue à Maison Daouia, comment pouvons-nous vous aider ?";
          if (pageLang.startsWith("en")) tooltipMsg = "Welcome to Maison Daouia, how can we help you?";
          if (pageLang.startsWith("es")) tooltipMsg = "Bienvenido a Maison Daouia, ¿cómo podemos ayudarle?";

          tooltip.innerText = tooltipMsg;

          document.body.appendChild(btn);
          document.body.appendChild(tooltip);

          setTimeout(() => tooltip.classList.add("show"), 1000);
          setTimeout(() => tooltip.classList.remove("show"), 6000);
        }
      });

      /* -------------------------------------------------------
         LISTEN TO i18next LANGUAGE CHANGE EVENTS (LIVE UPDATE)
      ------------------------------------------------------- */
      window.addEventListener("languageChanged", () => updateBadge());
    </script>

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
      /* WhatsApp Button */
      .whatsapp-float {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #879b61;
        color: white;
        border-radius: 50%;
        width: 55px;
        height: 55px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        cursor: pointer;
        z-index: 9999;
      }

      .whatsapp-tooltip {
        position: fixed;
        bottom: 85px;
        right: 20px;
        background: #879b61;
        color: white;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 13px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        z-index: 9999;
        opacity: 0;
        transition: opacity 0.4s ease;
      }
      .whatsapp-tooltip.show { opacity: 1; }

      /* Booking Badge */
      #mgh-badge {
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 9999;
        width: 100px;
        cursor: pointer;
      }
      #mgh-badge img {
        width: 100%;
        height: auto;
      }

      @media (max-width: 768px) {
        .whatsapp-float {
          width: 50px;
          height: 50px;
          font-size: 20px;
        }
        #mgh-badge {
          width: 80px;
        }
      }
    </style>

  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
